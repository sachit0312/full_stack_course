(this.webpackJsonplearn=this.webpackJsonplearn||[]).push([[0],{42:function(t,e,n){},43:function(t,e,n){"use strict";n.r(e);var r=n(17),c=n.n(r),a=n(8),o=n(3),u=n.n(o),i=n(6),s=n(5),l=n(1),j=n(0),f=function(t){var e=t.note,n=t.toggleImportance,r=t.deleteNote,c=e.important?"make not important":"make important";return Object(j.jsxs)("li",{className:"note",children:[Object(j.jsx)("p",{children:e.content}),Object(j.jsx)("button",{onClick:n,children:c}),Object(j.jsx)("button",{onClick:r,children:"delete"})]})},d=function(t){var e=t.message;return null===e?null:Object(j.jsx)("div",{className:"error",children:e})},b=function(){return Object(j.jsxs)("div",{style:{color:"green",fontStyle:"italic",fontSize:16},children:[Object(j.jsx)("br",{}),Object(j.jsx)("em",{children:"Note app, Sachit Goyal 2021"})]})},p=n(4),h=n.n(p),O="api/notes",m=null,v=function(){var t=h.a.get(O);return console.log(t),t.then((function(t){return t.data}))},x=function(t){var e={headers:{Authorization:m}};return h.a.post(O,t,e).then((function(t){return t.data}))},g=function(t,e){return h.a.put("".concat(O,"/").concat(t),e).then((function(t){return t.data}))},w=function(t){return h.a.delete("".concat(O,"/").concat(t)).then((function(t){return t.data}))},k=function(t){m="bearer ".concat(t)},y={login:function(){var t=Object(i.a)(u.a.mark((function t(e){var n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h.a.post("/api/login",e);case 2:return n=t.sent,t.abrupt("return",n.data);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),create:function(){var t=Object(i.a)(u.a.mark((function t(e){var n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h.a.post("/api/users",e);case 2:return n=t.sent,t.abrupt("return",n.data);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},S=function(){var t,e=Object(l.useState)([]),n=Object(s.a)(e,2),r=n[0],c=n[1],o=Object(l.useState)(""),p=Object(s.a)(o,2),h=p[0],O=p[1],m=Object(l.useState)(!1),S=Object(s.a)(m,2),N=S[0],C=S[1],I=Object(l.useState)(null),T=Object(s.a)(I,2),U=T[0],J=T[1],z=Object(l.useState)(""),A=Object(s.a)(z,2),D=A[0],E=A[1],L=Object(l.useState)(""),M=Object(s.a)(L,2),P=M[0],W=M[1],B=Object(l.useState)(null),F=Object(s.a)(B,2),G=F[0],H=F[1],q=function(){var e=Object(i.a)(u.a.mark((function e(n){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),1!==t){e.next=20;break}return e.prev=2,e.next=5,y.login({username:D,password:P});case 5:r=e.sent,window.localStorage.setItem("loggedNoteappUser",JSON.stringify(r)),k(r.token),K(r.token.id),H(r),E(""),W(""),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(2),J("Wrong credentials"),setTimeout((function(){J(null)}),5e3);case 18:e.next=33;break;case 20:return e.prev=20,e.next=23,y.create({username:D,password:P});case 23:J("Account Created."),H(null),E(""),W(""),e.next=33;break;case 29:e.prev=29,e.t1=e.catch(20),J("Wrong credentials"),setTimeout((function(){J(null)}),5e3);case 33:case"end":return e.stop()}}),e,null,[[2,14],[20,29]])})));return function(t){return e.apply(this,arguments)}}(),K=function(t){v().then((function(e){!function(t,e){var n=t.filter((function(t){return t.user===e}));c(n)}(e,t)}))};Object(l.useEffect)((function(){var t=window.localStorage.getItem("loggedNoteappUser");if(t){var e=JSON.parse(t);H(e),k(e.token)}}),[]);var Q=function(t){t.preventDefault();var e={content:h,important:Math.random()>.5};x(e).then((function(t){c(r.concat(t)),O("")})).catch((function(t){J("Note '".concat(e.content,"' is too short")),setTimeout((function(){J(null)}),5e3)}))},R=function(){window.localStorage.removeItem("loggedNoteappUser"),H(null)},V=function(t){console.log(t.target.value),O(t.target.value)},X=N?r:r.filter((function(t){return t.important}));return Object(j.jsxs)("div",{children:[Object(j.jsx)("h1",{children:"Notes"}),Object(j.jsx)(d,{message:U}),null===G?Object(j.jsxs)("form",{onSubmit:q,children:[Object(j.jsxs)("div",{children:[Object(j.jsx)("p",{children:"Username"}),Object(j.jsx)("input",{type:"text",value:D,name:"Username",onChange:function(t){var e=t.target;return E(e.value)}})]}),Object(j.jsxs)("div",{children:[Object(j.jsx)("p",{children:"Password"}),Object(j.jsx)("input",{type:"password",value:P,name:"Password",onChange:function(t){var e=t.target;return W(e.value)}})]}),Object(j.jsx)("button",{type:"submit",onClick:function(){return t=1},children:"Login"}),Object(j.jsx)("button",{type:"submit",onClick:function(){return t=2},children:"Create "})]}):Object(j.jsxs)("div",{children:[Object(j.jsxs)("p",{children:["Hey ",G.name,". Manage and remember your notes. "]}),Object(j.jsxs)(j.Fragment,{children:[Object(j.jsxs)("form",{onSubmit:Q,children:[Object(j.jsx)("input",{value:h,onChange:V}),Object(j.jsx)("button",{type:"submit",children:"save"})]}),Object(j.jsx)("div",{children:Object(j.jsxs)("button",{onClick:function(){return C(!N)},children:["show ",N?"important":"all"]})}),Object(j.jsx)("ul",{children:X.map((function(t){return Object(j.jsx)(f,{note:t,toggleImportance:function(){return function(t){var e=r.find((function(e){return e.id===t})),n=Object(a.a)(Object(a.a)({},e),{},{important:!e.important});g(t,n).then((function(e){c(r.map((function(n){return n.id!==t?n:e})))})).catch((function(t){J("Note '".concat(e.content,"' was already removed from server")),setTimeout((function(){J(null)}),5e3)}))}(t.id)},deleteNote:function(){return function(t){var e=r.find((function(e){return e.id===t}));w(t).then((function(e){console.log(e),c(r.filter((function(e){return e.id!==t})))})).catch((function(t){J("Note '".concat(e.content,"' was already removed from server")),setTimeout((function(){J(null)}),5e3)}))}(t.id)}},t.id)}))}),Object(j.jsx)("p",{}),Object(j.jsx)("button",{onClick:R,children:"Logout"})]})]}),Object(j.jsx)(b,{})]})};n(42);c.a.render(Object(j.jsx)(S,{}),document.getElementById("root"))}},[[43,1,2]]]);
//# sourceMappingURL=main.21e04a26.chunk.js.map